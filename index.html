<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gym Tracker</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#0f172a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <style>
        body {
            visibility: hidden;
        }
    </style>
    <script>
        if (!localStorage.getItem('gym_token')) {
            window.location.href = '/login.html';
        } else {
            document.addEventListener('DOMContentLoaded', () => {
                document.body.style.visibility = 'visible';
            });
        }
    </script>
</head>

<body>
    <div id="rest-overlay" class="rest-overlay" style="display:none;">
        <div class="rest-card">
            <p class="rest-label">Descanso</p>
            <div class="rest-ring-wrapper">
                <svg class="rest-ring" viewBox="0 0 120 120">
                    <circle class="rest-ring-bg" cx="60" cy="60" r="52" />
                    <circle id="rest-ring-progress" class="rest-ring-fill" cx="60" cy="60" r="52" />
                </svg>
                <div class="rest-time-wrap">
                    <span id="rest-countdown">90</span>
                    <span class="rest-unit">seg</span>
                </div>
            </div>
            <button id="btn-skip-rest" class="rest-skip-btn">Saltar â†’</button>
        </div>
    </div>
    <main>
        <section id="hub" class="page active">
            <h1 class="h1-hub">Buenos dÃ­as, <br><span>DarÃ­o</span></h1>
            <span class="subtitle">Martes, 10 Feb â€¢ Â¡A entrenar!</span>

            <div class="card input-weight">
                <label>Registro rÃ¡pido</label>
                <div class="weight-control-row">
                    <button class="step" onclick="adjustWeight(-0.05)">âˆ’</button>
                    <div class="weight-display">
                        <input type="number" class="weight-input" value="63" step="0.1">
                        <span class="weight-label">Kg actuales</span>
                    </div>
                    <button class="step" onclick="adjustWeight(0.05)">+</button>
                </div>
                <button id="btn-guardar-peso" class="nextBtn" style="margin-top: 12px;">Guardar peso</button>
                <p id="peso-feedback"
                    style="text-align:center; font-size:0.85rem; color:#94a3b8; margin-top:8px; display:none;"></p>
            </div>

            <div class="card trend-card">
                <div class="trend-info">
                    <div class="trend-title">Progreso Semanal</div>
                    <div class="trend-period">vs. semana pasada</div>
                </div>
                <div class="trend-badge up">
                    <span>â†—</span> +0.45 kg
                </div>
            </div>

            <div class="card graph-card">
                <div class="graph-header">
                    <span class="graph-title">EvoluciÃ³n</span>
                </div>
                <div class="graph">
                    <canvas id="pesoChart"></canvas>
                </div>
            </div>
        </section>

        <section id="entrenamiento" class="page">
            <div id="training-container">
                <button id="btn-back" class="backBtn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"
                        class="ios-back">
                        <path d="m15 18-6-6 6-6" />
                    </svg></button>

                <div class="container">
                    <button id="btn-sustituir" title="Sustituir ejercicio">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8" />
                            <path d="M21 3v5h-5" />
                            <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16" />
                            <path d="M8 16H3v5" />
                        </svg>
                    </button>
                    <h1 id="serie-display" class="serie-titulo">Serie 1</h1>
                    <h2 id="ejercicio-display" class="ejercicio-titulo">Press Banca</h2>

                    <div class="input-group">
                        <div>
                            <label class="input-label">Peso (Kg)</label>
                            <input id="input-peso" type="number" placeholder="0">
                        </div>
                        <div>
                            <label class="input-label">Repeticiones</label>
                            <input id="input-reps" type="number" placeholder="0">
                        </div>
                        <div>
                            <label class="input-label">RIR</label>
                            <input id="input-rir" type="number" placeholder="0">
                        </div>
                        <div>
                            <button id="btn-next-set" class="nextBtn">Siguiente Serie</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="completeScreen" id="finish-screen">
                <h1 class="complete-icon">ðŸŽ‰</h1>
                <h2 class="complete-title">Â¡Entrenamiento Completado!</h2>
                <p class="complete-subtitle">Has machacado todas las series.</p>

                <div class="finish-buttons">
                    <button class="nextBtn btn-secondary">Ver Resumen / Editar</button>
                    <button class="nextBtn" id="finalizar-todo-btn">Finalizar y Salir</button>
                </div>
            </div>
        </section>

        <section id="progreso" class="page">
            <h1>Progreso</h1>
            <div class="container">

                <div class="input-group">
                    <label>Selecciona ejercicio</label>
                    <select id="ejercicio-select"></select>
                </div>
            </div>
            <!-- Spinner de carga -->
            <div id="loading-spinner" style="display:none"></div>
            <div class="card graph-card">
                <div class="graph">
                    <canvas id="volumenChart"></canvas>
                </div>
            </div>
        </section>
    </main>

    <nav>
        <button id="hubBtn" class="nav-btn active">Hub</button>
        <button id="entrenamientoBtn" class="nav-btn">Entreno</button>
        <button id="progresoBtn" class="nav-btn">Progreso</button>
    </nav>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="script.js"></script>
</body>

</html>